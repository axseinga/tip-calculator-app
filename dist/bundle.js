!function(){"use strict";var e,t,n={},r={};function o(e){var t=r[e];if(void 0!==t)return t.exports;var c=r[e]={id:e,exports:{}};return n[e](c,c.exports,o),c.exports}o.m=n,o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,{a:t}),t},o.d=function(e,t){for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.f={},o.e=function(e){return Promise.all(Object.keys(o.f).reduce((function(t,n){return o.f[n](e,t),t}),[]))},o.u=function(e){return e+".bundle.js"},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},e={},t="tip-calculator-app-main:",o.l=function(n,r,c,u){if(e[n])e[n].push(r);else{var l,i;if(void 0!==c)for(var a=document.getElementsByTagName("script"),p=0;p<a.length;p++){var d=a[p];if(d.getAttribute("src")==n||d.getAttribute("data-webpack")==t+c){l=d;break}}l||(i=!0,(l=document.createElement("script")).charset="utf-8",l.timeout=120,o.nc&&l.setAttribute("nonce",o.nc),l.setAttribute("data-webpack",t+c),l.src=n),e[n]=[r];var s=function(t,r){l.onerror=l.onload=null,clearTimeout(f);var o=e[n];if(delete e[n],l.parentNode&&l.parentNode.removeChild(l),o&&o.forEach((function(e){return e(r)})),t)return t(r)},f=setTimeout(s.bind(null,void 0,{type:"timeout",target:l}),12e4);l.onerror=s.bind(null,l.onerror),l.onload=s.bind(null,l.onload),i&&document.head.appendChild(l)}},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.p="",function(){o.b=document.baseURI||self.location.href;var e={179:0};o.f.j=function(t,n){var r=o.o(e,t)?e[t]:void 0;if(0!==r)if(r)n.push(r[2]);else{var c=new Promise((function(n,o){r=e[t]=[n,o]}));n.push(r[2]=c);var u=o.p+o.u(t),l=new Error;o.l(u,(function(n){if(o.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var c=n&&("load"===n.type?"missing":n.type),u=n&&n.target&&n.target.src;l.message="Loading chunk "+t+" failed.\n("+c+": "+u+")",l.name="ChunkLoadError",l.type=c,l.request=u,r[1](l)}}),"chunk-"+t,t)}};var t=function(t,n){var r,c,u=n[0],l=n[1],i=n[2],a=0;for(r in l)o.o(l,r)&&(o.m[r]=l[r]);for(i&&i(o),t&&t(n);a<u.length;a++)c=u[a],o.o(e,c)&&e[c]&&e[c][0](),e[u[a]]=0},n=self.webpackChunktip_calculator_app_main=self.webpackChunktip_calculator_app_main||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();class c{getTotal(){const e=this.getBill(),t=this.getPct(),n=this.getPeople(),r=this.calcTotal(e,t,n);this.displayTotal(r)}getBill(){const e=document.querySelector(".calc-input__input-bill").value;return NaN==e||"undefined"==people?0:e}getPct(){const e=document.querySelectorAll(".calc-input__selection"),[t]=Array.from(e).filter((e=>!0===e.checked));return t?t.getAttribute("value"):0}getPeople(){const e=document.querySelector(".calc-input__input-people").value;return""===e?0:e}customButton(){document.querySelectorAll(".calc-input__selection").forEach((e=>e.checked=!1))}calcTip(e,t,n){if(0===t||0===n)return 0;{const r=e*t/100/n;return Math.round(100*r)/100}}calcTotal(e,t,n){if(0===t&&n>0){const t=+e/+n;return Math.round(100*t)/100}if(0===n&&t>0)return 0;if(0===t&&0===n)return 0;{const r=e/n+ +this.calcTip(+e,+t,+n);return Math.round(100*r)/100}}convertToDisplay(e){return e.toFixed(Math.max(((e+"").split(".")[1]||"").length,2))}displayTip(e){const t=this.convertToDisplay(e);document.querySelector(".calc-output__tip-display").innerText=`$${t}`}displayTotal(e){const t=this.convertToDisplay(e);document.querySelector(".calc-output__total-display").innerText=`$${t}`}reset(){const e=document.querySelector(".calc-input__input-bill"),t=document.querySelector(".calc-input__textarea"),n=document.querySelector(".calc-input__input-people"),r=document.querySelectorAll(".calc-input__selection"),o=document.querySelector(".calc-output__total-display"),c=document.querySelector(".calc-output__tip-display");e.value="",r.forEach((e=>e.checked=!1)),t.value="",n.value="",c.innerText="$0.00",o.innerText="$0.00"}}function u(e,t){const n=e.getBill(),r=t,o=e.getPeople(),c=e.calcTip(n,r,o),u=e.calcTotal(n,r,o);e.displayTip(c),e.displayTotal(u)}o.e(3).then(o.bind(o,3)),document.addEventListener("DOMContentLoaded",(function(){const e=new c;document.querySelector(".calc-output__reset").addEventListener("click",e.reset),document.querySelector(".calc-input__input-bill").addEventListener("keyup",(()=>{u(e,e.getPct())})),document.querySelector(".calc-input__input-people").addEventListener("keyup",(()=>{u(e,e.getPct())}));const t=document.querySelectorAll(".calc-input__selection");Array.from(t).forEach((t=>t.addEventListener("click",(()=>{u(e,e.getPct())}))));const n=document.querySelector(".calc-input__textarea");n.addEventListener("keyup",(()=>{e.customButton();const t=n.value;u(e,t)}))}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QnBGLFNBQVMwRCxHQUNqQ0EsRUFBTXlCLGlCQUFpQixTQUFTLEtBQzVCSCxFQUFVQyxFQUFZQSxFQUFXckMsZUFHekMsTUFBTXlDLEVBQWlCMUcsU0FBU3VFLGNBQWMseUJBQzlDbUMsRUFBZUYsaUJBQWlCLFNBQVMsS0FDckNGLEVBQVdyQixlQUNYLE1BQU1qRCxFQUFRMEUsRUFBZTFFLE1BQzdCcUUsRUFBVUMsRUFBWXRFLFMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90aXAtY2FsY3VsYXRvci1hcHAtbWFpbi93ZWJwYWNrL3J1bnRpbWUvbG9hZCBzY3JpcHQiLCJ3ZWJwYWNrOi8vdGlwLWNhbGN1bGF0b3ItYXBwLW1haW4vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vdGlwLWNhbGN1bGF0b3ItYXBwLW1haW4vd2VicGFjay9ydW50aW1lL2NvbXBhdCBnZXQgZGVmYXVsdCBleHBvcnQiLCJ3ZWJwYWNrOi8vdGlwLWNhbGN1bGF0b3ItYXBwLW1haW4vd2VicGFjay9ydW50aW1lL2RlZmluZSBwcm9wZXJ0eSBnZXR0ZXJzIiwid2VicGFjazovL3RpcC1jYWxjdWxhdG9yLWFwcC1tYWluL3dlYnBhY2svcnVudGltZS9lbnN1cmUgY2h1bmsiLCJ3ZWJwYWNrOi8vdGlwLWNhbGN1bGF0b3ItYXBwLW1haW4vd2VicGFjay9ydW50aW1lL2dldCBqYXZhc2NyaXB0IGNodW5rIGZpbGVuYW1lIiwid2VicGFjazovL3RpcC1jYWxjdWxhdG9yLWFwcC1tYWluL3dlYnBhY2svcnVudGltZS9oYXNPd25Qcm9wZXJ0eSBzaG9ydGhhbmQiLCJ3ZWJwYWNrOi8vdGlwLWNhbGN1bGF0b3ItYXBwLW1haW4vd2VicGFjay9ydW50aW1lL21ha2UgbmFtZXNwYWNlIG9iamVjdCIsIndlYnBhY2s6Ly90aXAtY2FsY3VsYXRvci1hcHAtbWFpbi93ZWJwYWNrL3J1bnRpbWUvcHVibGljUGF0aCIsIndlYnBhY2s6Ly90aXAtY2FsY3VsYXRvci1hcHAtbWFpbi93ZWJwYWNrL3J1bnRpbWUvanNvbnAgY2h1bmsgbG9hZGluZyIsIndlYnBhY2s6Ly90aXAtY2FsY3VsYXRvci1hcHAtbWFpbi8uL3NyYy9qcy9jYWxjLmpzIiwid2VicGFjazovL3RpcC1jYWxjdWxhdG9yLWFwcC1tYWluLy4vc3JjL2pzL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbInZhciBpblByb2dyZXNzID0ge307XG52YXIgZGF0YVdlYnBhY2tQcmVmaXggPSBcInRpcC1jYWxjdWxhdG9yLWFwcC1tYWluOlwiO1xuLy8gbG9hZFNjcmlwdCBmdW5jdGlvbiB0byBsb2FkIGEgc2NyaXB0IHZpYSBzY3JpcHQgdGFnXG5fX3dlYnBhY2tfcmVxdWlyZV9fLmwgPSBmdW5jdGlvbih1cmwsIGRvbmUsIGtleSwgY2h1bmtJZCkge1xuXHRpZihpblByb2dyZXNzW3VybF0pIHsgaW5Qcm9ncmVzc1t1cmxdLnB1c2goZG9uZSk7IHJldHVybjsgfVxuXHR2YXIgc2NyaXB0LCBuZWVkQXR0YWNoO1xuXHRpZihrZXkgIT09IHVuZGVmaW5lZCkge1xuXHRcdHZhciBzY3JpcHRzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJzY3JpcHRcIik7XG5cdFx0Zm9yKHZhciBpID0gMDsgaSA8IHNjcmlwdHMubGVuZ3RoOyBpKyspIHtcblx0XHRcdHZhciBzID0gc2NyaXB0c1tpXTtcblx0XHRcdGlmKHMuZ2V0QXR0cmlidXRlKFwic3JjXCIpID09IHVybCB8fCBzLmdldEF0dHJpYnV0ZShcImRhdGEtd2VicGFja1wiKSA9PSBkYXRhV2VicGFja1ByZWZpeCArIGtleSkgeyBzY3JpcHQgPSBzOyBicmVhazsgfVxuXHRcdH1cblx0fVxuXHRpZighc2NyaXB0KSB7XG5cdFx0bmVlZEF0dGFjaCA9IHRydWU7XG5cdFx0c2NyaXB0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc2NyaXB0Jyk7XG5cblx0XHRzY3JpcHQuY2hhcnNldCA9ICd1dGYtOCc7XG5cdFx0c2NyaXB0LnRpbWVvdXQgPSAxMjA7XG5cdFx0aWYgKF9fd2VicGFja19yZXF1aXJlX18ubmMpIHtcblx0XHRcdHNjcmlwdC5zZXRBdHRyaWJ1dGUoXCJub25jZVwiLCBfX3dlYnBhY2tfcmVxdWlyZV9fLm5jKTtcblx0XHR9XG5cdFx0c2NyaXB0LnNldEF0dHJpYnV0ZShcImRhdGEtd2VicGFja1wiLCBkYXRhV2VicGFja1ByZWZpeCArIGtleSk7XG5cdFx0c2NyaXB0LnNyYyA9IHVybDtcblx0fVxuXHRpblByb2dyZXNzW3VybF0gPSBbZG9uZV07XG5cdHZhciBvblNjcmlwdENvbXBsZXRlID0gZnVuY3Rpb24ocHJldiwgZXZlbnQpIHtcblx0XHQvLyBhdm9pZCBtZW0gbGVha3MgaW4gSUUuXG5cdFx0c2NyaXB0Lm9uZXJyb3IgPSBzY3JpcHQub25sb2FkID0gbnVsbDtcblx0XHRjbGVhclRpbWVvdXQodGltZW91dCk7XG5cdFx0dmFyIGRvbmVGbnMgPSBpblByb2dyZXNzW3VybF07XG5cdFx0ZGVsZXRlIGluUHJvZ3Jlc3NbdXJsXTtcblx0XHRzY3JpcHQucGFyZW50Tm9kZSAmJiBzY3JpcHQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChzY3JpcHQpO1xuXHRcdGRvbmVGbnMgJiYgZG9uZUZucy5mb3JFYWNoKGZ1bmN0aW9uKGZuKSB7IHJldHVybiBmbihldmVudCk7IH0pO1xuXHRcdGlmKHByZXYpIHJldHVybiBwcmV2KGV2ZW50KTtcblx0fVxuXHQ7XG5cdHZhciB0aW1lb3V0ID0gc2V0VGltZW91dChvblNjcmlwdENvbXBsZXRlLmJpbmQobnVsbCwgdW5kZWZpbmVkLCB7IHR5cGU6ICd0aW1lb3V0JywgdGFyZ2V0OiBzY3JpcHQgfSksIDEyMDAwMCk7XG5cdHNjcmlwdC5vbmVycm9yID0gb25TY3JpcHRDb21wbGV0ZS5iaW5kKG51bGwsIHNjcmlwdC5vbmVycm9yKTtcblx0c2NyaXB0Lm9ubG9hZCA9IG9uU2NyaXB0Q29tcGxldGUuYmluZChudWxsLCBzY3JpcHQub25sb2FkKTtcblx0bmVlZEF0dGFjaCAmJiBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKHNjcmlwdCk7XG59OyIsIi8vIFRoZSBtb2R1bGUgY2FjaGVcbnZhciBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18gPSB7fTtcblxuLy8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbmZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG5cdHZhciBjYWNoZWRNb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdO1xuXHRpZiAoY2FjaGVkTW9kdWxlICE9PSB1bmRlZmluZWQpIHtcblx0XHRyZXR1cm4gY2FjaGVkTW9kdWxlLmV4cG9ydHM7XG5cdH1cblx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcblx0dmFyIG1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7XG5cdFx0aWQ6IG1vZHVsZUlkLFxuXHRcdC8vIG5vIG1vZHVsZS5sb2FkZWQgbmVlZGVkXG5cdFx0ZXhwb3J0czoge31cblx0fTtcblxuXHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cblx0X193ZWJwYWNrX21vZHVsZXNfX1ttb2R1bGVJZF0obW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cblx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcblx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xufVxuXG4vLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuX193ZWJwYWNrX3JlcXVpcmVfXy5tID0gX193ZWJwYWNrX21vZHVsZXNfXztcblxuIiwiLy8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbl9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuXHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cblx0XHRmdW5jdGlvbigpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcblx0XHRmdW5jdGlvbigpIHsgcmV0dXJuIG1vZHVsZTsgfTtcblx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgeyBhOiBnZXR0ZXIgfSk7XG5cdHJldHVybiBnZXR0ZXI7XG59OyIsIi8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb25zIGZvciBoYXJtb255IGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIGRlZmluaXRpb24pIHtcblx0Zm9yKHZhciBrZXkgaW4gZGVmaW5pdGlvbikge1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhkZWZpbml0aW9uLCBrZXkpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywga2V5KSkge1xuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIGtleSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGRlZmluaXRpb25ba2V5XSB9KTtcblx0XHR9XG5cdH1cbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5mID0ge307XG4vLyBUaGlzIGZpbGUgY29udGFpbnMgb25seSB0aGUgZW50cnkgY2h1bmsuXG4vLyBUaGUgY2h1bmsgbG9hZGluZyBmdW5jdGlvbiBmb3IgYWRkaXRpb25hbCBjaHVua3Ncbl9fd2VicGFja19yZXF1aXJlX18uZSA9IGZ1bmN0aW9uKGNodW5rSWQpIHtcblx0cmV0dXJuIFByb21pc2UuYWxsKE9iamVjdC5rZXlzKF9fd2VicGFja19yZXF1aXJlX18uZikucmVkdWNlKGZ1bmN0aW9uKHByb21pc2VzLCBrZXkpIHtcblx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmZba2V5XShjaHVua0lkLCBwcm9taXNlcyk7XG5cdFx0cmV0dXJuIHByb21pc2VzO1xuXHR9LCBbXSkpO1xufTsiLCIvLyBUaGlzIGZ1bmN0aW9uIGFsbG93IHRvIHJlZmVyZW5jZSBhc3luYyBjaHVua3Ncbl9fd2VicGFja19yZXF1aXJlX18udSA9IGZ1bmN0aW9uKGNodW5rSWQpIHtcblx0Ly8gcmV0dXJuIHVybCBmb3IgZmlsZW5hbWVzIGJhc2VkIG9uIHRlbXBsYXRlXG5cdHJldHVybiBcIlwiICsgY2h1bmtJZCArIFwiLmJ1bmRsZS5qc1wiO1xufTsiLCJfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmosIHByb3ApIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3ApOyB9IiwiLy8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuXHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcblx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcblx0fVxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xufTsiLCJfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiOyIsIl9fd2VicGFja19yZXF1aXJlX18uYiA9IGRvY3VtZW50LmJhc2VVUkkgfHwgc2VsZi5sb2NhdGlvbi5ocmVmO1xuXG4vLyBvYmplY3QgdG8gc3RvcmUgbG9hZGVkIGFuZCBsb2FkaW5nIGNodW5rc1xuLy8gdW5kZWZpbmVkID0gY2h1bmsgbm90IGxvYWRlZCwgbnVsbCA9IGNodW5rIHByZWxvYWRlZC9wcmVmZXRjaGVkXG4vLyBbcmVzb2x2ZSwgcmVqZWN0LCBQcm9taXNlXSA9IGNodW5rIGxvYWRpbmcsIDAgPSBjaHVuayBsb2FkZWRcbnZhciBpbnN0YWxsZWRDaHVua3MgPSB7XG5cdDE3OTogMFxufTtcblxuX193ZWJwYWNrX3JlcXVpcmVfXy5mLmogPSBmdW5jdGlvbihjaHVua0lkLCBwcm9taXNlcykge1xuXHRcdC8vIEpTT05QIGNodW5rIGxvYWRpbmcgZm9yIGphdmFzY3JpcHRcblx0XHR2YXIgaW5zdGFsbGVkQ2h1bmtEYXRhID0gX193ZWJwYWNrX3JlcXVpcmVfXy5vKGluc3RhbGxlZENodW5rcywgY2h1bmtJZCkgPyBpbnN0YWxsZWRDaHVua3NbY2h1bmtJZF0gOiB1bmRlZmluZWQ7XG5cdFx0aWYoaW5zdGFsbGVkQ2h1bmtEYXRhICE9PSAwKSB7IC8vIDAgbWVhbnMgXCJhbHJlYWR5IGluc3RhbGxlZFwiLlxuXG5cdFx0XHQvLyBhIFByb21pc2UgbWVhbnMgXCJjdXJyZW50bHkgbG9hZGluZ1wiLlxuXHRcdFx0aWYoaW5zdGFsbGVkQ2h1bmtEYXRhKSB7XG5cdFx0XHRcdHByb21pc2VzLnB1c2goaW5zdGFsbGVkQ2h1bmtEYXRhWzJdKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGlmKHRydWUpIHsgLy8gYWxsIGNodW5rcyBoYXZlIEpTXG5cdFx0XHRcdFx0Ly8gc2V0dXAgUHJvbWlzZSBpbiBjaHVuayBjYWNoZVxuXHRcdFx0XHRcdHZhciBwcm9taXNlID0gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7IGluc3RhbGxlZENodW5rRGF0YSA9IGluc3RhbGxlZENodW5rc1tjaHVua0lkXSA9IFtyZXNvbHZlLCByZWplY3RdOyB9KTtcblx0XHRcdFx0XHRwcm9taXNlcy5wdXNoKGluc3RhbGxlZENodW5rRGF0YVsyXSA9IHByb21pc2UpO1xuXG5cdFx0XHRcdFx0Ly8gc3RhcnQgY2h1bmsgbG9hZGluZ1xuXHRcdFx0XHRcdHZhciB1cmwgPSBfX3dlYnBhY2tfcmVxdWlyZV9fLnAgKyBfX3dlYnBhY2tfcmVxdWlyZV9fLnUoY2h1bmtJZCk7XG5cdFx0XHRcdFx0Ly8gY3JlYXRlIGVycm9yIGJlZm9yZSBzdGFjayB1bndvdW5kIHRvIGdldCB1c2VmdWwgc3RhY2t0cmFjZSBsYXRlclxuXHRcdFx0XHRcdHZhciBlcnJvciA9IG5ldyBFcnJvcigpO1xuXHRcdFx0XHRcdHZhciBsb2FkaW5nRW5kZWQgPSBmdW5jdGlvbihldmVudCkge1xuXHRcdFx0XHRcdFx0aWYoX193ZWJwYWNrX3JlcXVpcmVfXy5vKGluc3RhbGxlZENodW5rcywgY2h1bmtJZCkpIHtcblx0XHRcdFx0XHRcdFx0aW5zdGFsbGVkQ2h1bmtEYXRhID0gaW5zdGFsbGVkQ2h1bmtzW2NodW5rSWRdO1xuXHRcdFx0XHRcdFx0XHRpZihpbnN0YWxsZWRDaHVua0RhdGEgIT09IDApIGluc3RhbGxlZENodW5rc1tjaHVua0lkXSA9IHVuZGVmaW5lZDtcblx0XHRcdFx0XHRcdFx0aWYoaW5zdGFsbGVkQ2h1bmtEYXRhKSB7XG5cdFx0XHRcdFx0XHRcdFx0dmFyIGVycm9yVHlwZSA9IGV2ZW50ICYmIChldmVudC50eXBlID09PSAnbG9hZCcgPyAnbWlzc2luZycgOiBldmVudC50eXBlKTtcblx0XHRcdFx0XHRcdFx0XHR2YXIgcmVhbFNyYyA9IGV2ZW50ICYmIGV2ZW50LnRhcmdldCAmJiBldmVudC50YXJnZXQuc3JjO1xuXHRcdFx0XHRcdFx0XHRcdGVycm9yLm1lc3NhZ2UgPSAnTG9hZGluZyBjaHVuayAnICsgY2h1bmtJZCArICcgZmFpbGVkLlxcbignICsgZXJyb3JUeXBlICsgJzogJyArIHJlYWxTcmMgKyAnKSc7XG5cdFx0XHRcdFx0XHRcdFx0ZXJyb3IubmFtZSA9ICdDaHVua0xvYWRFcnJvcic7XG5cdFx0XHRcdFx0XHRcdFx0ZXJyb3IudHlwZSA9IGVycm9yVHlwZTtcblx0XHRcdFx0XHRcdFx0XHRlcnJvci5yZXF1ZXN0ID0gcmVhbFNyYztcblx0XHRcdFx0XHRcdFx0XHRpbnN0YWxsZWRDaHVua0RhdGFbMV0oZXJyb3IpO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fTtcblx0XHRcdFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmwodXJsLCBsb2FkaW5nRW5kZWQsIFwiY2h1bmstXCIgKyBjaHVua0lkLCBjaHVua0lkKTtcblx0XHRcdFx0fSBlbHNlIGluc3RhbGxlZENodW5rc1tjaHVua0lkXSA9IDA7XG5cdFx0XHR9XG5cdFx0fVxufTtcblxuLy8gbm8gcHJlZmV0Y2hpbmdcblxuLy8gbm8gcHJlbG9hZGVkXG5cbi8vIG5vIEhNUlxuXG4vLyBubyBITVIgbWFuaWZlc3RcblxuLy8gbm8gb24gY2h1bmtzIGxvYWRlZFxuXG4vLyBpbnN0YWxsIGEgSlNPTlAgY2FsbGJhY2sgZm9yIGNodW5rIGxvYWRpbmdcbnZhciB3ZWJwYWNrSnNvbnBDYWxsYmFjayA9IGZ1bmN0aW9uKHBhcmVudENodW5rTG9hZGluZ0Z1bmN0aW9uLCBkYXRhKSB7XG5cdHZhciBjaHVua0lkcyA9IGRhdGFbMF07XG5cdHZhciBtb3JlTW9kdWxlcyA9IGRhdGFbMV07XG5cdHZhciBydW50aW1lID0gZGF0YVsyXTtcblx0Ly8gYWRkIFwibW9yZU1vZHVsZXNcIiB0byB0aGUgbW9kdWxlcyBvYmplY3QsXG5cdC8vIHRoZW4gZmxhZyBhbGwgXCJjaHVua0lkc1wiIGFzIGxvYWRlZCBhbmQgZmlyZSBjYWxsYmFja1xuXHR2YXIgbW9kdWxlSWQsIGNodW5rSWQsIGkgPSAwO1xuXHRmb3IobW9kdWxlSWQgaW4gbW9yZU1vZHVsZXMpIHtcblx0XHRpZihfX3dlYnBhY2tfcmVxdWlyZV9fLm8obW9yZU1vZHVsZXMsIG1vZHVsZUlkKSkge1xuXHRcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tW21vZHVsZUlkXSA9IG1vcmVNb2R1bGVzW21vZHVsZUlkXTtcblx0XHR9XG5cdH1cblx0aWYocnVudGltZSkgdmFyIHJlc3VsdCA9IHJ1bnRpbWUoX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cdGlmKHBhcmVudENodW5rTG9hZGluZ0Z1bmN0aW9uKSBwYXJlbnRDaHVua0xvYWRpbmdGdW5jdGlvbihkYXRhKTtcblx0Zm9yKDtpIDwgY2h1bmtJZHMubGVuZ3RoOyBpKyspIHtcblx0XHRjaHVua0lkID0gY2h1bmtJZHNbaV07XG5cdFx0aWYoX193ZWJwYWNrX3JlcXVpcmVfXy5vKGluc3RhbGxlZENodW5rcywgY2h1bmtJZCkgJiYgaW5zdGFsbGVkQ2h1bmtzW2NodW5rSWRdKSB7XG5cdFx0XHRpbnN0YWxsZWRDaHVua3NbY2h1bmtJZF1bMF0oKTtcblx0XHR9XG5cdFx0aW5zdGFsbGVkQ2h1bmtzW2NodW5rSWRzW2ldXSA9IDA7XG5cdH1cblxufVxuXG52YXIgY2h1bmtMb2FkaW5nR2xvYmFsID0gc2VsZltcIndlYnBhY2tDaHVua3RpcF9jYWxjdWxhdG9yX2FwcF9tYWluXCJdID0gc2VsZltcIndlYnBhY2tDaHVua3RpcF9jYWxjdWxhdG9yX2FwcF9tYWluXCJdIHx8IFtdO1xuY2h1bmtMb2FkaW5nR2xvYmFsLmZvckVhY2god2VicGFja0pzb25wQ2FsbGJhY2suYmluZChudWxsLCAwKSk7XG5jaHVua0xvYWRpbmdHbG9iYWwucHVzaCA9IHdlYnBhY2tKc29ucENhbGxiYWNrLmJpbmQobnVsbCwgY2h1bmtMb2FkaW5nR2xvYmFsLnB1c2guYmluZChjaHVua0xvYWRpbmdHbG9iYWwpKTsiLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBDYWxjdWxhdG9yIHtcbiAgICBnZXRUb3RhbCgpIHtcbiAgICAgICAgY29uc3QgYmlsbCA9IHRoaXMuZ2V0QmlsbCgpO1xuICAgICAgICBjb25zdCBwY3QgPSB0aGlzLmdldFBjdCgpO1xuICAgICAgICBjb25zdCBwZW9wbGUgPSB0aGlzLmdldFBlb3BsZSgpO1xuICAgICAgICBjb25zdCB0b3RhbCA9IHRoaXMuY2FsY1RvdGFsKGJpbGwsIHBjdCwgcGVvcGxlKTtcbiAgICAgICAgdGhpcy5kaXNwbGF5VG90YWwodG90YWwpO1xuICAgIH1cblxuICAgIGdldEJpbGwoKSB7XG4gICAgICAgIGNvbnN0IGJpbGxJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FsYy1pbnB1dF9faW5wdXQtYmlsbFwiKTtcbiAgICAgICAgY29uc3QgYmlsbCA9IGJpbGxJbnB1dC52YWx1ZTtcbiAgICAgICAgaWYgKGJpbGwgPT0gTmFOIHx8IHBlb3BsZSA9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBiaWxsO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZ2V0UGN0KCkge1xuICAgICAgICBjb25zdCByYWRpb0lucHV0cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuY2FsYy1pbnB1dF9fc2VsZWN0aW9uXCIpO1xuICAgICAgICBjb25zdCBbaW5wdXRDaGVja2VkXSA9IEFycmF5LmZyb20ocmFkaW9JbnB1dHMpLmZpbHRlcihcbiAgICAgICAgICAgIChpbnB1dCkgPT4gaW5wdXQuY2hlY2tlZCA9PT0gdHJ1ZVxuICAgICAgICApO1xuICAgICAgICBpZiAoaW5wdXRDaGVja2VkKSB7XG4gICAgICAgICAgICBjb25zdCBwY3QgPSBpbnB1dENoZWNrZWQuZ2V0QXR0cmlidXRlKFwidmFsdWVcIik7XG4gICAgICAgICAgICByZXR1cm4gcGN0O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBnZXRQZW9wbGUoKSB7XG4gICAgICAgIGNvbnN0IHBlb3BsZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYWxjLWlucHV0X19pbnB1dC1wZW9wbGVcIik7XG4gICAgICAgIGNvbnN0IHBlb3BsZSA9IHBlb3BsZUlucHV0LnZhbHVlO1xuICAgICAgICBpZiAocGVvcGxlID09PSBcIlwiKSB7XG4gICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBwZW9wbGU7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBjdXN0b21CdXR0b24oKSB7XG4gICAgICAgIGNvbnN0IHJhZGlvSW5wdXRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5jYWxjLWlucHV0X19zZWxlY3Rpb25cIik7XG4gICAgICAgIHJhZGlvSW5wdXRzLmZvckVhY2goKGlucHV0KSA9PiAoaW5wdXQuY2hlY2tlZCA9IGZhbHNlKSk7XG4gICAgfVxuXG4gICAgY2FsY1RpcChiaWxsLCBwY3QsIHBlb3BsZSkge1xuICAgICAgICBpZiAocGN0ID09PSAwIHx8IHBlb3BsZSA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zdCB0aXAgPSAoYmlsbCAqIHBjdCkgLyAxMDAgLyBwZW9wbGU7XG4gICAgICAgICAgICBjb25zdCB0aXBSb3VuZCA9IE1hdGgucm91bmQodGlwICogMTAwKSAvIDEwMDtcbiAgICAgICAgICAgIHJldHVybiB0aXBSb3VuZDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGNhbGNUb3RhbChiaWxsLCBwY3QsIHBlb3BsZSkge1xuICAgICAgICBpZiAocGN0ID09PSAwICYmIHBlb3BsZSA+IDApIHtcbiAgICAgICAgICAgIGNvbnN0IHRvdGFsID0gK2JpbGwgLyArcGVvcGxlO1xuICAgICAgICAgICAgY29uc3QgdG90YWxSb3VuZCA9IE1hdGgucm91bmQodG90YWwgKiAxMDApIC8gMTAwO1xuICAgICAgICAgICAgcmV0dXJuIHRvdGFsUm91bmQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBlb3BsZSA9PT0gMCAmJiBwY3QgPiAwKSB7XG4gICAgICAgICAgICBjb25zdCB0b3RhbCA9IDA7XG4gICAgICAgICAgICByZXR1cm4gdG90YWw7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAocGN0ID09PSAwICYmIHBlb3BsZSA9PT0gMCkge1xuICAgICAgICAgICAgY29uc3QgdG90YWwgPSAwO1xuICAgICAgICAgICAgcmV0dXJuIHRvdGFsO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgdGlwID0gdGhpcy5jYWxjVGlwKCtiaWxsLCArcGN0LCArcGVvcGxlKTtcbiAgICAgICAgICAgIGNvbnN0IHRvdGFsID0gYmlsbCAvIHBlb3BsZSArICt0aXA7XG4gICAgICAgICAgICBjb25zdCB0b3RhbFJvdW5kID0gTWF0aC5yb3VuZCh0b3RhbCAqIDEwMCkgLyAxMDA7XG4gICAgICAgICAgICByZXR1cm4gdG90YWxSb3VuZDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGNvbnZlcnRUb0Rpc3BsYXkobnVtKSB7XG4gICAgICAgIGNvbnN0IG5ld051bSA9IG51bS50b0ZpeGVkKFxuICAgICAgICAgICAgTWF0aC5tYXgoKChudW0gKyBcIlwiKS5zcGxpdChcIi5cIilbMV0gfHwgXCJcIikubGVuZ3RoLCAyKVxuICAgICAgICApO1xuICAgICAgICByZXR1cm4gbmV3TnVtO1xuICAgIH1cblxuICAgIGRpc3BsYXlUaXAodGlwKSB7XG4gICAgICAgIGNvbnN0IHRpcERpc3BsYXkgPSB0aGlzLmNvbnZlcnRUb0Rpc3BsYXkodGlwKTtcbiAgICAgICAgY29uc3QgdGlwQW1vdW50RGlzcGxheSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICAgICAgICBcIi5jYWxjLW91dHB1dF9fdGlwLWRpc3BsYXlcIlxuICAgICAgICApO1xuICAgICAgICB0aXBBbW91bnREaXNwbGF5LmlubmVyVGV4dCA9IGAkJHt0aXBEaXNwbGF5fWA7XG4gICAgfVxuXG4gICAgZGlzcGxheVRvdGFsKHRvdGFsKSB7XG4gICAgICAgIGNvbnN0IHRvdGFsRGlzcGxheSA9IHRoaXMuY29udmVydFRvRGlzcGxheSh0b3RhbCk7XG4gICAgICAgIGNvbnN0IHRvdGFsQW1vdW50RGlzcGxheSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICAgICAgICBcIi5jYWxjLW91dHB1dF9fdG90YWwtZGlzcGxheVwiXG4gICAgICAgICk7XG4gICAgICAgIHRvdGFsQW1vdW50RGlzcGxheS5pbm5lclRleHQgPSBgJCR7dG90YWxEaXNwbGF5fWA7XG4gICAgfVxuXG4gICAgcmVzZXQoKSB7XG4gICAgICAgIGNvbnN0IGJpbGxJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FsYy1pbnB1dF9faW5wdXQtYmlsbFwiKTtcbiAgICAgICAgY29uc3QgcmFkaW9DdXN0b21JbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICAgICAgICBcIi5jYWxjLWlucHV0X190ZXh0YXJlYVwiXG4gICAgICAgICk7XG4gICAgICAgIGNvbnN0IHBlb3BsZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYWxjLWlucHV0X19pbnB1dC1wZW9wbGVcIik7XG4gICAgICAgIGNvbnN0IHJhZGlvSW5wdXRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5jYWxjLWlucHV0X19zZWxlY3Rpb25cIik7XG4gICAgICAgIGNvbnN0IHRvdGFsQW1vdW50RGlzcGxheSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICAgICAgICBcIi5jYWxjLW91dHB1dF9fdG90YWwtZGlzcGxheVwiXG4gICAgICAgICk7XG4gICAgICAgIGNvbnN0IHRpcEFtb3VudERpc3BsYXkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgICAgICAgXCIuY2FsYy1vdXRwdXRfX3RpcC1kaXNwbGF5XCJcbiAgICAgICAgKTtcbiAgICAgICAgYmlsbElucHV0LnZhbHVlID0gXCJcIjtcbiAgICAgICAgcmFkaW9JbnB1dHMuZm9yRWFjaCgoaW5wdXQpID0+IChpbnB1dC5jaGVja2VkID0gZmFsc2UpKTtcbiAgICAgICAgcmFkaW9DdXN0b21JbnB1dC52YWx1ZSA9IFwiXCI7XG4gICAgICAgIHBlb3BsZUlucHV0LnZhbHVlID0gXCJcIjtcbiAgICAgICAgdGlwQW1vdW50RGlzcGxheS5pbm5lclRleHQgPSBcIiQwLjAwXCI7XG4gICAgICAgIHRvdGFsQW1vdW50RGlzcGxheS5pbm5lclRleHQgPSBcIiQwLjAwXCI7XG4gICAgfVxufVxuIiwiaW1wb3J0KFwiLi8uLi9zYXNzL21haW4uc2Nzc1wiKTtcblxuaW1wb3J0IENhbGN1bGF0b3IgZnJvbSBcIi4vY2FsYy5qc1wiO1xuXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLCBpbml0KTtcblxuZnVuY3Rpb24gaW5pdCgpIHtcbiAgICBjb25zdCBjYWxjdWxhdG9yID0gbmV3IENhbGN1bGF0b3IoKTtcbiAgICBjb25zdCByZXNldEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FsYy1vdXRwdXRfX3Jlc2V0XCIpO1xuICAgIHJlc2V0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBjYWxjdWxhdG9yLnJlc2V0KTtcbiAgICBjb25zdCBiaWxsQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYWxjLWlucHV0X19pbnB1dC1iaWxsXCIpO1xuICAgIGJpbGxCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImtleXVwXCIsICgpID0+IHtcbiAgICAgICAgY2FsY3VsYXRlKGNhbGN1bGF0b3IsIGNhbGN1bGF0b3IuZ2V0UGN0KCkpO1xuICAgIH0pO1xuICAgIGNvbnN0IHBlb3BsZUJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FsYy1pbnB1dF9faW5wdXQtcGVvcGxlXCIpO1xuICAgIHBlb3BsZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwia2V5dXBcIiwgKCkgPT4ge1xuICAgICAgICBjYWxjdWxhdGUoY2FsY3VsYXRvciwgY2FsY3VsYXRvci5nZXRQY3QoKSk7XG4gICAgfSk7XG4gICAgY29uc3QgcmFkaW9JbnB1dHNCdG5zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5jYWxjLWlucHV0X19zZWxlY3Rpb25cIik7XG4gICAgQXJyYXkuZnJvbShyYWRpb0lucHV0c0J0bnMpLmZvckVhY2goKGlucHV0KSA9PlxuICAgICAgICBpbnB1dC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgICAgICAgY2FsY3VsYXRlKGNhbGN1bGF0b3IsIGNhbGN1bGF0b3IuZ2V0UGN0KCkpO1xuICAgICAgICB9KVxuICAgICk7XG4gICAgY29uc3QgY3VzdG9tSW5wdXRCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhbGMtaW5wdXRfX3RleHRhcmVhXCIpO1xuICAgIGN1c3RvbUlucHV0QnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJrZXl1cFwiLCAoKSA9PiB7XG4gICAgICAgIGNhbGN1bGF0b3IuY3VzdG9tQnV0dG9uKCk7XG4gICAgICAgIGNvbnN0IHZhbHVlID0gY3VzdG9tSW5wdXRCdG4udmFsdWU7XG4gICAgICAgIGNhbGN1bGF0ZShjYWxjdWxhdG9yLCB2YWx1ZSk7XG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIGNhbGN1bGF0ZShjYWxjdWxhdG9yLCBjYWxjUGN0Rm4pIHtcbiAgICBjb25zdCBiaWxsID0gY2FsY3VsYXRvci5nZXRCaWxsKCk7XG4gICAgY29uc3QgcGN0ID0gY2FsY1BjdEZuO1xuICAgIGNvbnN0IHBlb3BsZSA9IGNhbGN1bGF0b3IuZ2V0UGVvcGxlKCk7XG4gICAgY29uc3QgdGlwID0gY2FsY3VsYXRvci5jYWxjVGlwKGJpbGwsIHBjdCwgcGVvcGxlKTtcbiAgICBjb25zdCB0b3RhbCA9IGNhbGN1bGF0b3IuY2FsY1RvdGFsKGJpbGwsIHBjdCwgcGVvcGxlKTtcbiAgICBjYWxjdWxhdG9yLmRpc3BsYXlUaXAodGlwKTtcbiAgICBjYWxjdWxhdG9yLmRpc3BsYXlUb3RhbCh0b3RhbCk7XG59XG4iXSwibmFtZXMiOlsiaW5Qcm9ncmVzcyIsImRhdGFXZWJwYWNrUHJlZml4IiwiX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiY2FjaGVkTW9kdWxlIiwidW5kZWZpbmVkIiwiZXhwb3J0cyIsIm1vZHVsZSIsImlkIiwiX193ZWJwYWNrX21vZHVsZXNfXyIsIm0iLCJuIiwiZ2V0dGVyIiwiX19lc01vZHVsZSIsImQiLCJhIiwiZGVmaW5pdGlvbiIsImtleSIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJmIiwiZSIsImNodW5rSWQiLCJQcm9taXNlIiwiYWxsIiwia2V5cyIsInJlZHVjZSIsInByb21pc2VzIiwidSIsIm9iaiIsInByb3AiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsImNhbGwiLCJsIiwidXJsIiwiZG9uZSIsInB1c2giLCJzY3JpcHQiLCJuZWVkQXR0YWNoIiwic2NyaXB0cyIsImRvY3VtZW50IiwiZ2V0RWxlbWVudHNCeVRhZ05hbWUiLCJpIiwibGVuZ3RoIiwicyIsImdldEF0dHJpYnV0ZSIsImNyZWF0ZUVsZW1lbnQiLCJjaGFyc2V0IiwidGltZW91dCIsIm5jIiwic2V0QXR0cmlidXRlIiwic3JjIiwib25TY3JpcHRDb21wbGV0ZSIsInByZXYiLCJldmVudCIsIm9uZXJyb3IiLCJvbmxvYWQiLCJjbGVhclRpbWVvdXQiLCJkb25lRm5zIiwicGFyZW50Tm9kZSIsInJlbW92ZUNoaWxkIiwiZm9yRWFjaCIsImZuIiwic2V0VGltZW91dCIsImJpbmQiLCJ0eXBlIiwidGFyZ2V0IiwiaGVhZCIsImFwcGVuZENoaWxkIiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJwIiwiYiIsImJhc2VVUkkiLCJzZWxmIiwibG9jYXRpb24iLCJocmVmIiwiaW5zdGFsbGVkQ2h1bmtzIiwiaiIsImluc3RhbGxlZENodW5rRGF0YSIsInByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwiZXJyb3IiLCJFcnJvciIsImVycm9yVHlwZSIsInJlYWxTcmMiLCJtZXNzYWdlIiwibmFtZSIsInJlcXVlc3QiLCJ3ZWJwYWNrSnNvbnBDYWxsYmFjayIsInBhcmVudENodW5rTG9hZGluZ0Z1bmN0aW9uIiwiZGF0YSIsImNodW5rSWRzIiwibW9yZU1vZHVsZXMiLCJydW50aW1lIiwiY2h1bmtMb2FkaW5nR2xvYmFsIiwiQ2FsY3VsYXRvciIsImdldFRvdGFsIiwiYmlsbCIsInRoaXMiLCJnZXRCaWxsIiwicGN0IiwiZ2V0UGN0IiwicGVvcGxlIiwiZ2V0UGVvcGxlIiwidG90YWwiLCJjYWxjVG90YWwiLCJkaXNwbGF5VG90YWwiLCJxdWVyeVNlbGVjdG9yIiwiTmFOIiwicmFkaW9JbnB1dHMiLCJxdWVyeVNlbGVjdG9yQWxsIiwiaW5wdXRDaGVja2VkIiwiQXJyYXkiLCJmcm9tIiwiZmlsdGVyIiwiaW5wdXQiLCJjaGVja2VkIiwiY3VzdG9tQnV0dG9uIiwiY2FsY1RpcCIsInRpcCIsIk1hdGgiLCJyb3VuZCIsImNvbnZlcnRUb0Rpc3BsYXkiLCJudW0iLCJ0b0ZpeGVkIiwibWF4Iiwic3BsaXQiLCJkaXNwbGF5VGlwIiwidGlwRGlzcGxheSIsImlubmVyVGV4dCIsInRvdGFsRGlzcGxheSIsInJlc2V0IiwiYmlsbElucHV0IiwicmFkaW9DdXN0b21JbnB1dCIsInBlb3BsZUlucHV0IiwidG90YWxBbW91bnREaXNwbGF5IiwidGlwQW1vdW50RGlzcGxheSIsImNhbGN1bGF0ZSIsImNhbGN1bGF0b3IiLCJjYWxjUGN0Rm4iLCJhZGRFdmVudExpc3RlbmVyIiwicmFkaW9JbnB1dHNCdG5zIiwiY3VzdG9tSW5wdXRCdG4iXSwic291cmNlUm9vdCI6IiJ9